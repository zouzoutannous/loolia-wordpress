'use strict';var ThemifyBuilderCommon;
(function(f,r,d,q){d!==window.self&&(window.wp.shortcode=d.wp.shortcode);ThemifyBuilderCommon={loader:null,showLoader(a){null===this.loader&&(this.loader=f(d.document.getElementById("tb_alert")));const b=this.loader[0];"show"===a?(b.classList.add("tb_busy"),b.style.display="block"):"spinhide"===a?this.loader.fadeOut(300,function(){this.classList.remove("tb_busy")}):("error"!==a&&(a="done"),b.classList.remove("tb_busy"),b.classList.add("tb_"+a),this.loader.delay(500).fadeOut(500,function(){this.classList.remove("tb_"+
a)}))},clone(a){if(null===a)return a;void 0!==a[0]&&(a=a[0]);a=a.cloneNode(!0);f(a).find("#tb_component_bar").empty().attr("id","").closest(".tb_clicked").removeClass("tb_clicked");if("visual"===tb_app.mode){var b=a.getElementsByTagName("video");if(0<b.length){var c=a.getElementsByClassName("big-video-wrap");for(let a=b.length-1;-1<a;--a)b[a].pause();for(b=c.length-1;-1<b;--b)c[b]&&c[b].remove()}c=a.getElementsByClassName("tb_dragger");for(b=c.length-1;-1<b;--b)c[b].remove()}return f(a)},Clipboard:{key:"themify_builder_clipboard_",
set(a,b){const c={};c[a]=b;localStorage.setItem(this.key+"content",JSON.stringify(c))},get(a){const b=JSON.parse(localStorage.getItem(this.key+"content"));return void 0!==b[a]?b[a]:!1}},alertWrongPaste(){alert(themifyBuilder.i18n.text_alert_wrong_paste)},autoComplete(a){var b=f(".themify_tax_autocomplete",a);if(0<b.length){var c=[];b.each(function(){var a=f(this),b=a.closest(".tb_input").find("input.query_category_multiple"),d=b.val();f(this).autocomplete({minLength:2,source(b,c){b=f.trim(b.term);
f.getJSON(themifyBuilder.ajaxurl,{term:f.trim(b),tax:a.data("tax"),action:a.data("action")},function(a,b,e){c(a)})},select(a,c){b.val(c.item.value);this.value=c.item.label;return!1}}).focus(function(){f(this).autocomplete("search");return!1});if(d&&"undefined"!==d){var m={};m[a.data("tax")]=d;c.push(m)}else b.val("")});0<c.length&&f.ajax({url:themifyBuilder.ajaxurl,type:"POST",dataType:"json",data:{data:c,action:"themify_builder_get_tax_data"},success(b){if(b)for(var c in b)f("#themify_search_cat_"+
b[c].tax,a).val(b[c].val)}})}},Lightbox:{$lightbox:null,lightboxStorageKey:d!==window.self?"themify_builder_lightbox_frontend_pos_size":"themify_builder_lightbox_backend_pos_size",setup(){d.document.body.appendChild(q.getElementById("tmpl-builder_lightbox").content);this.$lightbox=f("#tb_lightbox_parent",d.document);ThemifyBuilderCommon.LiteLightbox.modal=new wp.media.view.Modal({controller:{trigger(){}}});ThemifyBuilderCommon.LiteLightbox.modal.on("attach",function(){this.el.classList.add("tb_lite_lightbox_modal")});
this.bindEvents()},bindEvents(){const a=this;a.responsiveTabs();a.$lightbox.one("themify_opened_lightbox",function(){a.resizable.init();"visual"===tb_app.mode&&a.$lightbox[0].getElementsByClassName("builder_cancel_docked_mode")[0].addEventListener("click",function(a){a.preventDefault();a.stopPropagation();a=this.ownerDocument.body.classList;a.add("themify_lightbox_drag");ThemifyBuilderCommon.Lightbox.dockMode.close();a.remove("themify_lightbox_drag")});a.$lightbox[0].getElementsByClassName("tb_close_lightbox")[0].addEventListener("click",
function(){a.close()},{passive:!0})});themifyBuilder.disableShortcuts||a.controlByKeyInput()},getLightboxStorage(){const a=localStorage.getItem(this.lightboxStorageKey);return a?JSON.parse(a):{}},updateLightboxStorage(a){localStorage.setItem(this.lightboxStorageKey,JSON.stringify(Object.assign(this.getLightboxStorage(),a)))},resizable:{$el:null,init(){const a=this,b=tb_app.Utils.getMouseEvents(),c=ThemifyBuilderCommon.Lightbox,e=d.document.body.classList;this.$el=c.$lightbox;var n=this.$el[0].getElementsByClassName("tb_resizable");
const g=this.$el[0].querySelectorAll(".tb_lightbox_top_bar,.tb_action_breadcrumb");for(let d=n.length-1;-1<d;--d)n[d].addEventListener(b.mousedown,function(d){if("touchstart"===d.type||1===d.which){d.stopImmediatePropagation();let h;const l=this.ownerDocument,m=parseInt(a.$el.css("min-height")),g=.9*l.documentElement.clientHeight,k=this.dataset.axis,n=parseInt(a.$el[0].offsetHeight,10),p=parseInt(a.$el[0].offsetWidth,10),q=d.touches?d.touches[0].clientX:d.clientX,t=d.touches?d.touches[0].clientY:
d.clientY,u=function(b){b.stopImmediatePropagation();h&&cancelAnimationFrame(h);h=requestAnimationFrame(function(){const c=a.$el[0];var e=b.touches?b.touches[0].clientX:b.clientX;var d=b.touches?b.touches[0].clientY:b.clientY;if("w"===k)e=q+p-e,880<e&&(e=880),350<=e&&880>=e&&(d=c.style.width,c.style.width=e+"px",c.style.left=parseInt(c.style.left)+parseInt(d)-e+"px",a.setupLightboxSizeClass(e));else{d="-y"===k||"ne"===k||"nw"===k?t+n-d:n+d-t;e="sw"===k||"nw"===k?q+p-e:p+e-q;880<e&&(e=880);if(("se"===
k||"x"===k||"sw"===k||"nw"===k||"ne"===k)&&350<=e&&880>=e){const b=c.style.width;c.style.width=e+"px";if("sw"===k||"nw"===k)c.style.left=parseInt(c.style.left)+parseInt(b)-e+"px";a.setupLightboxSizeClass(e)}if(("se"===k||"y"===k||"-y"===k||"sw"===k||"nw"===k||"ne"===k)&&d>=m&&d<=g){if("-y"===k||"nw"===k||"ne"===k)c.style.top=parseInt(c.style.top)+parseInt(c.style.height)-d+"px";c.style.height=d+"px"}}r.body.triggerHandler("themify_builder_resize_lightbox")})};l.addEventListener(b.mousemove,u,{passive:!0});
l.addEventListener(b.mouseup,function(d){d.stopImmediatePropagation();this.removeEventListener(b.mousemove,u,{passive:!0});h&&cancelAnimationFrame(h);h=null;c.fixContainment();a.remember();this.body.style.cursor="";e.remove("tb_start_animate","tb_move_drag","tb_panel_resize")},{passive:!0,once:!0});e.add("tb_start_animate","tb_move_drag","tb_panel_resize");"se"!==k&&"x"!==k&&"sw"!==k&&"ne"!==k&&"nw"!==k||a.setupLightboxSizeClass();l.body.style.cursor=f(this).css("cursor")}},{passive:!0});for(n=g.length-
1;-1<n;--n)g[n].addEventListener(b.mousedown,function(d){if("touchstart"===d.type||1===d.which){const p=c.dockMode.get()&&!e.contains("tb_standalone_lightbox")&&(this.classList.contains("tb_action_breadcrumb")||d.target.classList.contains("tb_lightbox_top_bar"));if(p||d.target.classList.contains("tb_lightbox_top_bar")){d.stopImmediatePropagation();var g,h,l=a.$el[0],f=this.ownerDocument,n=l.offsetLeft-(d.touches?d.touches[0].clientX:d.clientX),k=l.offsetTop-(d.touches?d.touches[0].clientY:d.clientY),
m=function(a){a.stopImmediatePropagation();g&&cancelAnimationFrame(g);g=requestAnimationFrame(function(){const b=n+(a.touches?a.touches[0].clientX:a.clientX),d=k+(a.touches?a.touches[0].clientY:a.clientY);l.style.left=b+"px";l.style.top=d+"px";c.dockMode.drag(a,b)})},q=function(a){h=!0;a.stopImmediatePropagation();if(p){a=l.offsetLeft;const b=l.offsetTop;l.getElementsByClassName("builder_cancel_docked_mode")[0].click();l.style.left=a+"px";l.style.top=b+"px"}e.add("tb_start_animate","tb_move_drag",
"themify_lightbox_drag")};f.addEventListener(b.mouseup,function(d){this.removeEventListener(b.mousemove,q,{passive:!0,once:!0});this.removeEventListener(b.mousemove,m,{passive:!0});h&&(m(d),requestAnimationFrame(function(){g=l=h=null;c.fixContainment();e.remove("tb_start_animate","tb_move_drag","themify_lightbox_drag")}),a.remember())},{passive:!0,once:!0});f.addEventListener(b.mousemove,q,{passive:!0,once:!0});f.addEventListener(b.mousemove,m,{passive:!0})}}},{passive:!0});a.setupLightboxSizeClass()},
remember(){if(!d.document.body.classList.contains("tb_standalone_lightbox")){var a=ThemifyBuilderCommon.Lightbox.resizable;const b=a.$el.position();a={top:b.top,left:b.left,width:a.$el.outerWidth(),height:a.$el.outerHeight()};ThemifyBuilderCommon.Lightbox.updateLightboxStorage(a);r.body.triggerHandler("themify_builder_resize_lightbox")}},setupLightboxSizeClass(a){if(null!==this.$el){a||(a=parseInt(this.$el.width()));const b=this.$el[0].classList;750<a?b.add("larger-lightbox"):b.remove("larger-lightbox");
540>a?b.add("tb_lightbox_small"):b.remove("tb_lightbox_small")}}},fixContainment(){var a=this.$lightbox[0].getBoundingClientRect();const b=a.width,c=window.innerWidth-20,d=window.innerHeight-30,f=a.left;a=a.top;const g={};0>f?g.left=20:f+b>c&&(g.left=c-b);0>a?g.top=0:a>d&&(g.top=d);for(let a in g)this.$lightbox[0].style[a]=g[a]+"px"},setStandAlone(a,b,c){const e=this.$lightbox.outerWidth(),f=this.$lightbox.outerHeight(),g=d.document.documentElement.clientWidth,m=d.document.documentElement.clientHeight;
c||"visual"!==tb_app.mode||(this.dockMode.get()&&(tb_app.toolbar.$el.find(".tb_toolbar_add_modules").click(),d.document.body.classList.contains("tb_panel_minimized")||("desktop"!==tb_app.activeBreakPoint?a+=this.dockMode.isLeft?150:-150:this.dockMode.isLeft&&(a+=300))),"desktop"!==tb_app.activeBreakPoint&&(a+=(g-tb_app.iframe.width())/2+8));a-=e/2;5>=a?a=5:a+e>g&&(a=g-e-20);b+=50;b+f>m&&(b=m-f-5);0>b&&(b=5);this.$lightbox.css({left:a,top:b}).one("themify_opened_lightbox",function(){tb_app.Utils.addViewPortClass(this)})},
open(a,b,c){const e=ThemifyBuilderCommon.Lightbox,n=d.document,g=n.getElementById("tb_lightbox_container"),m=function(p){e.$lightbox[0].style.display="none";for("function"===typeof b&&b.call(e,p);null!==g.firstChild;)g.removeChild(g.firstChild);"string"===typeof p?g.innerHTML=p:g.appendChild(p);p=n.body.classList.contains("tb_standalone_lightbox");var h=null;if(!1===p){var l={top:100,left:Math.max(0,f(d).width()/2-300),width:600,height:500};Object.assign(l,e.getLightboxStorage())}else l={top:"",left:"",
width:"",height:""};for(var m in l)e.$lightbox[0].style[m]=""!==l[m]?l[m]+"px":"";!1===p&&(!0===e.dockMode.get()?(e.dockMode.setDoc(),h=!0):e.fixContainment());"function"===typeof c&&c.call(e,g);null===h&&e.resizable.setupLightboxSizeClass(l.width);e.$lightbox[0].style.display="block";e.$lightbox.triggerHandler("themify_opened_lightbox");if("inline"!==a.loadMethod)for(m=g.getElementsByClassName("tb_tabs"),p=m.length-1;-1<p;--p)for(l=m[p].getElementsByTagName("a"),h=l.length-1;-1<h;--h)l[h].addEventListener("click",
ThemifyConstructor.switchTabs);tb_app.Instances.Builder[tb_app.builderIndex].lastRowShowHide()};"inline"===a.loadMethod?(r.body.triggerHandler("themify_builder_lightbox_close"),n.body.classList.remove("tb_standalone_lightbox"),m(ThemifyConstructor.run(a.templateID))):"html"===a.loadMethod?(tb_app.autoSaveCid=null,e.close(!0),!0===a.contructor?m(ThemifyConstructor.run(a.data,a.save)):m(a.data)):(ThemifyBuilderCommon.showLoader("show"),tb_app.autoSaveCid=null,e.close(!0),a.data.nonce=themifyBuilder.tb_load_nonce,
a=_.defaults(a||{},{type:"POST",url:themifyBuilder.ajaxurl}),f.ajax(a).done(function(b){!0===a.contructor?m(ThemifyConstructor.run(b)):m(b);ThemifyBuilderCommon.showLoader("spinhide")}))},close(a){const b=ThemifyBuilderCommon.Lightbox;r.body.triggerHandler("themify_builder_lightbox_before_close");"visual"===tb_app.mode&&d.jQuery("body").trigger("themify_builder_lightbox_close",a);a||(b.$lightbox[0].style.display="none",tb_app.autoSaveCid=null);b._cleanLightBoxContent();a||(tb_app.undoManager.updateUndoBtns(),
tb_app.Instances.Builder[tb_app.builderIndex].lastRowShowHide(!0),tb_app.Utils.removeViewPortClass(b.$lightbox[0]));tb_app.ActionBar.hoverCid=null;tb_app.ActionBar.clearSelected();r.body.triggerHandler("themify_builder_lightbox_close",a)},dockMode:{key:"themify_builder_docked",leftKey:"themify_builder_docked_left",workspace:d.document.body.getElementsByClassName("tb_workspace_container")[0],minEl:null,width:322,isDocked:null,isLeft:null,set(a){(this.isDocked=a)?(localStorage.setItem(this.key,a),this.isLeft?
localStorage.setItem(this.leftKey,!0):localStorage.removeItem(this.leftKey)):(localStorage.removeItem(this.key),localStorage.removeItem(this.leftKey));r.body.triggerHandler("themify_builder_resize_lightbox")},get(){return"visual"===tb_app.mode&&(null===this.isDocked&&(this.isDocked="true"===localStorage.getItem(this.key)),!0===this.isDocked)?(this.isLeft="true"===localStorage.getItem(this.leftKey),!0):!1},minimize(a){a.stopPropagation();a=d.document.body.classList;a.contains("tb_panel_minimized")?
a.remove("tb_panel_minimized"):a.add("tb_panel_minimized");tb_app.Utils._onResize(!0)},setDoc(){null===tb_app.toolbar.getStorage()&&localStorage.setItem(this.key,!0);if(this.get()){const a=d.document.body.classList,b=tb_app;a.contains("tb_panel_docked")?ThemifyBuilderCommon.Lightbox.resizable.setupLightboxSizeClass(this.width):(a.add("tb_panel_docked"),this.isLeft?(a.add("tb_panel_left_dock"),a.remove("tb_panel_right_dock")):(a.add("tb_panel_right_dock"),a.remove("tb_panel_left_dock")),b.Utils._onResize(!0),
ThemifyBuilderCommon.Lightbox.resizable.setupLightboxSizeClass(this.width),r.body.triggerHandler("themify_builder_resize_lightbox"),this.minEl=tb_app.toolbar.el.getElementsByClassName("tb_docked_minimize")[0],this.minEl.addEventListener("click",this.minimize,{passive:!0}),b.Views.Toolbar.prototype.removeFloat(),b.Views.Toolbar.prototype.openFloat(),b.Views.Toolbar.prototype._setResponsiveTabs())}},drag(a,b){if("visual"===tb_app.mode&&!this.get()){const c=d.document.body.classList;if(!c.contains("tb_standalone_lightbox")){const e=
a.clientX+20>=d.innerWidth;a=a.type;this.isLeft=!e&&0>b;!e&&!this.isLeft||"mousemove"!==a&&"touchmove"!==a?c.remove("tb_dock_highlight","tb_dock_left_highlight"):(c.add("tb_dock_highlight"),this.isLeft?c.add("tb_dock_left_highlight"):c.remove("tb_dock_left_highlight"));!e&&!this.isLeft||"mouseup"!==a&&"touchend"!==a||(this.set(!0),this.setDoc())}}},close(a){if("visual"===tb_app.mode&&this.get()){const c=ThemifyBuilderCommon.Lightbox,e=d.document.body.classList;var b=c.getLightboxStorage();b={width:b.width?
b.width:c.resizable.minWidth,height:b.height?b.height:c.resizable.minHeight,top:d.innerHeight/2-c.$lightbox.innerHeight()/2,left:d.innerWidth/2-c.$lightbox.innerWidth()/2};c.$lightbox.css(b);a&&d.document.body.classList.contains("tb_panel_closed")&&tb_app.Views.Toolbar.prototype.openFloat();if(this.isLeft||!a)a?this.isLeft?e.remove("tb_panel_right_dock"):e.remove("tb_panel_left_dock"):(e.remove("tb_panel_left_dock","tb_panel_right_dock","tb_panel_docked"),null!==this.minEl&&(this.minEl.removeEventListener("click",
this.minimize,{passive:!0}),this.minEl=null),null!==tb_app.activeModel&&localStorage.getItem("tb_panel_closed")&&tb_app.Views.Toolbar.prototype.closeFloat(),tb_app.Views.Toolbar.prototype.setFloat(),e.contains("tb_standalone_lightbox")||this.set(null));c.resizable.setupLightboxSizeClass(b.width);tb_app.Utils._onResize(!0)}}},_cleanLightBoxContent(){let a=this.$lightbox.find("#tb_lightbox_container")[0];for(;null!==a.firstChild;)a.removeChild(a.firstChild);for(a=this.$lightbox[0].getElementsByClassName("tb_options_tab")[0];null!==
a.firstChild;)a.removeChild(a.firstChild);for(a=this.$lightbox[0].getElementsByClassName("tb_lightbox_actions_wrap")[0];null!==a.firstChild;)a.removeChild(a.firstChild);for(a=this.$lightbox[0].getElementsByClassName("tb_action_breadcrumb")[0];null!==a.firstChild;)a.removeChild(a.firstChild)},controlByKeyInput(){function a(a){if(27===a.keyCode&&tb_app.activeModel)a.preventDefault(),a.stopPropagation(),ThemifyBuilderCommon.Lightbox.close();else if(83===a.which&&(!0===a.ctrlKey||!0===a.metaKey)&&"INPUT"!==
d.document.activeElement.tagName&&"TEXTAREA"!==d.document.activeElement.tagName){a.preventDefault();a.stopPropagation();a=tb_app.activeModel?f(".builder_save_button",ThemifyBuilderCommon.Lightbox.$lightbox):null;if(null===a||0===a.length)a=tb_app.toolbar.$el.find(".tb_toolbar_save");a.click()}}f(q).on("keydown.tb_shortcut",a);if("visual"===tb_app.mode)f(d.document).on("keydown.tb_shortcut",a)},responsiveTabs(){var a=null,b,c,e=null,n=function(g,m,n){setTimeout(function(){if("styling"===ThemifyConstructor.clicked){a:{var h=
null===a?d.document.getElementById("tb_options_styling"):null;null===a&&(a=h.getElementsByClassName("tb_tabs")[0]);if(void 0!==a){if(!c)if(b=a.getElementsByTagName("ul")[0],void 0!==b)if(h=b.getElementsByTagName("li"),h=h[h.length-1],h=f(h),a=f(a),"rtl"===q.dir){const b=h.outerWidth(),e=d.innerWidth;c=e-(h.offset().left+b)+b-(e-(a.offset().left+a.outerWidth()))}else c=h.offset().left+h.outerWidth()-a.offset().left;else break a;a.innerWidth()<=c?(a[0].classList.add("tb_compact_tabs"),b.classList.add("tb_ui_dropdown_items"),
null===e&&(e=q.createElement("span"),e.className="tb_ui_dropdown_label",e.tabIndex="-1",e.textContent=b.getElementsByClassName("current")[0].textContent,b.parentNode.insertBefore(e,b))):(a[0].classList.remove("tb_compact_tabs"),b.classList.remove("tb_ui_dropdown_items"))}}"themify_builder_tabsactive"===g.type&&null!==e&&(e.textContent=b.getElementsByClassName("current")[0].textContent)}},4)};r.body.on("themify_builder_tabsactive themify_builder_resize_lightbox",n).on("themify_builder_lightbox_close",
function(){a=b=c=e=null});this.$lightbox.on("themify_opened_lightbox",n)}},LiteLightbox:{modal:null,confirmView:Backbone.View.extend({template:wp.template("builder_lite_lightbox_confirm"),className:"tb_lite_lightbox_content",initialize(a){this.options=a||{}},render(){this.el.innerHTML=this.template({message:this.options.message,buttons:this.options.buttons})},events:{"click button":"buttonClick"},buttonClick(a){a.preventDefault();this.trigger("litelightbox:confirm",f(a.currentTarget).data("type"))}}),
promptView:Backbone.View.extend({template:wp.template("builder_lite_lightbox_prompt"),className:"tb_lite_lightbox_content",initialize(a){this.options=a||{}},render(){this.$el.html(this.template(this.options))},events:{"click button":"buttonClick","keypress .tb_litelightbox_prompt_input":"keyPress"},buttonClick(a){a.preventDefault();this.trigger("litelightbox:prompt",f(a.currentTarget).data("type"),this.$el.find(".tb_litelightbox_prompt_input").val())},keyPress(a){13===a.which&&this.trigger("litelightbox:prompt",
"ok",f(a.currentTarget).val())}}),confirm(a,b,c){c=_.defaults(c||{},{buttons:{no:{label:"No"},yes:{label:"Yes"}}});c.message=a;a=new ThemifyBuilderCommon.LiteLightbox.confirmView(c);ThemifyBuilderCommon.LiteLightbox.modal.content(a);ThemifyBuilderCommon.LiteLightbox.modal.open();a.on("litelightbox:confirm",function(a){ThemifyBuilderCommon.LiteLightbox.modal.close();"function"===typeof b&&b.call(this,a)})},prompt(a,b,c){c=_.defaults(c||{},{buttons:{cancel:{label:"Cancel"},ok:{label:"OK"}}});c.message=
a;a=new ThemifyBuilderCommon.LiteLightbox.promptView(c);ThemifyBuilderCommon.LiteLightbox.modal.content(a);ThemifyBuilderCommon.LiteLightbox.modal.open();a.on("litelightbox:prompt",function(a,c){ThemifyBuilderCommon.LiteLightbox.modal.close();"function"===typeof b&&b.call(this,"cancel"===a?null:c)})},alert(a){ThemifyBuilderCommon.LiteLightbox.confirm(a,null,{buttons:{yes:{label:"OK"}}})}},templateCache:{templates:[],get(a){if(void 0===this.templates[a]){const b=q.getElementById(a);this.templates[a]=
b.innerHTML;setTimeout(function(){b.remove()},6E3)}return this.templates[a]}},setToolbar(){const a=q.getElementById("tb_toolbar_template"),b=a.content;"visual"===tb_app.mode?q.body.appendChild(b):a.parentNode.insertBefore(b,a);a.remove()},isImageUrl(a){if(!a)return!1;a=a.split("?")[0].split(".");return-1!=="jpg jpeg tiff png gif bmp svg".split(" ").indexOf(a[a.length-1])}}})(jQuery,Themify,window.top,document);
